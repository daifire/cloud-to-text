(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0968141f"],{1805:function(t,e,a){t.exports=a.p+"static/img/avatar2.c5124cc6.png"},"2ed3":function(t,e,a){var n={"./avatar0.png":"482d","./avatar1.png":"639c","./avatar2.png":"1805","./avatar3.png":"6947","./avatar4.png":"92b9","./avatar5.png":"6f92","./avatar6.png":"f23c","./avatar7.png":"b740","./avatar8.png":"dd0c","./avatar9.png":"328b"};function i(t){var e=r(t);return a(e)}function r(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=r,t.exports=i,i.id="2ed3"},"328b":function(t,e,a){t.exports=a.p+"static/img/avatar9.6505b97c.png"},"46ea":function(t,e,a){"use strict";a("e57d")},"482d":function(t,e,a){t.exports=a.p+"static/img/avatar0.999c09d4.png"},"639c":function(t,e,a){t.exports=a.p+"static/img/avatar1.1db6e61d.png"},6947:function(t,e,a){t.exports=a.p+"static/img/avatar3.ce71c7d3.png"},"6f92":function(t,e,a){t.exports=a.p+"static/img/avatar5.18d2251c.png"},"92b9":function(t,e,a){t.exports=a.p+"static/img/avatar4.ce6bec10.png"},b321:function(t,e,a){"use strict";var n=a("2fb8"),i=(n.roots["default"]||(n.roots["default"]=new n.Root)).addJSON({agora:{nested:{audio2text:{options:{java_package:"io.agora.rtc.audio2text",java_outer_classname:"Audio2TextProtobuffer"},nested:{Text:{fields:{vendor:{type:"int32",id:1},version:{type:"int32",id:2},seqnum:{type:"int32",id:3},uid:{type:"uint32",id:4},flag:{type:"int32",id:5},time:{type:"int64",id:6},lang:{type:"int32",id:7},starttime:{type:"int32",id:8},offtime:{type:"int32",id:9},words:{rule:"repeated",type:"Word",id:10}}},Word:{fields:{text:{type:"string",id:1},startMs:{type:"int32",id:2},durationMs:{type:"int32",id:3},isFinal:{type:"bool",id:4},confidence:{type:"double",id:5}}}}}}}});t.exports=i},b740:function(t,e,a){t.exports=a.p+"static/img/avatar7.903b312d.png"},dd0c:function(t,e,a){t.exports=a.p+"static/img/avatar8.f9519384.png"},dd7b:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[1==t.index?a("div",{staticClass:"fs24 mobile"},[a("el-button",{staticClass:"setting",attrs:{icon:"el-icon-setting",circle:""},on:{click:function(e){t.dialogFormVisible=!0}}}),a("el-form",{ref:"form",staticStyle:{"margin-top":"-7rem"},attrs:{model:t.options,"label-width":"110px",rules:t.rules}},[a("el-form-item",{attrs:{label:"User Name:",prop:"userName"}},[a("el-input",{attrs:{placeholder:"Enter Your Name"},on:{input:function(e){return t.options.userName=t.options.userName.toUpperCase()}},model:{value:t.options.userName,callback:function(e){t.$set(t.options,"userName",e)},expression:"options.userName"}})],1),a("el-form-item",{attrs:{label:"Room Name:",prop:"channel"}},[a("el-input",{attrs:{placeholder:"Enter Room Name","suffix-icon":"el-icon-s-home"},on:{input:function(e){return t.options.channel=t.options.channel.toUpperCase()}},model:{value:t.options.channel,callback:function(e){t.$set(t.options,"channel",e)},expression:"options.channel"}})],1),a("el-form-item",{attrs:{label:"Join As:"}},[a("el-radio-group",{model:{value:t.options.role,callback:function(e){t.$set(t.options,"role",e)},expression:"options.role"}},[a("el-radio",{staticStyle:{"margin-left":"-1rem"},attrs:{label:"host"}},[t._v("Host")]),a("el-radio",{staticStyle:{"margin-left":"-1rem"},attrs:{label:"audience"}},[t._v("Audience")])],1)],1),a("div",[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("JOIN")])],1)],1)],1):t._e(),2!=t.index||t.isMobile?t._e():a("div",{staticClass:"fs24 mobile1"},["audience"==t.options.role?a("div",{staticClass:"content"},[a("div",[a("span",[t._v("Room Name : "+t._s(this.options.channel))])]),t._l(t.userList,(function(e,n){return a("div",{key:n},[0==n?a("div",{staticClass:"item"},[a("div",{staticClass:"first"},[a("el-avatar",{attrs:{src:t.allData[e.uid].src}})],1),a("div",[a("div",{attrs:{id:"wrapperDiv"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"div1"}},[a("span",[t._v("User Name: "+t._s(e.name))]),a("span",[t._v(" (Self,Audience) ")]),a("div",{staticStyle:{float:"right"},attrs:{id:"div2"}},[t.left?a("el-button",{staticStyle:{"padding-left":"2px","padding-bottom":"2px","margin-left":"8px"},attrs:{circle:"",type:"success"}}):t._e()],1)])])])]):t._e(),n<5&&n>0?a("div",{staticClass:"itemContent"},[a("div",{staticClass:"top"},[a("div",{staticClass:"first"},[a("el-avatar",{attrs:{src:t.allData[e.uid].src}})],1),a("div",{attrs:{id:"wrapperDiv"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"div1"}},[a("span",[t._v("User Name: "+t._s(e.name))])])])]),t.allData[e.uid]?a("div",{staticClass:"bottom"},[a("p",{ref:"textContent",refInFor:!0,domProps:{innerHTML:t._s(t.allData[e.uid].stringBuilder)}})]):t._e()]):t._e()])}))],2):t._e(),"host"==t.options.role?a("div",{staticClass:"content"},[a("div",[a("span",[t._v("Room Name : "+t._s(this.options.channel))])]),t._l(t.userList,(function(e,n){return a("div",{key:n},[n<4?a("div",{staticClass:"itemContent"},[a("div",{staticClass:"top"},[a("div",{staticClass:"first"},[a("el-avatar",{attrs:{src:t.allData[e.uid].src}})],1),a("div",{attrs:{id:"wrapperDiv"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"div1"}},[a("span",[t._v("User Name: "+t._s(e.name))]),0==n?a("span",[t._v(" (Self,Host)")]):t._e(),a("div",{staticStyle:{float:"right"},attrs:{id:"div2"}},[t.left?a("el-button",{staticStyle:{"padding-left":"2px","padding-bottom":"2px","margin-left":"8px"},attrs:{circle:"",type:"success"}}):t._e()],1)])])]),t.allData[e.uid]?a("div",{staticClass:"bottom"},[a("p",{ref:"textContent",refInFor:!0,domProps:{innerHTML:t._s(t.allData[e.uid].stringBuilder)}})]):t._e()]):t._e()])}))],2):t._e(),a("div",{staticStyle:{position:"fixed",top:"580px",left:"50%","margin-left":"-24px",width:"200px","text-align":"left"}},[t.start?a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],staticStyle:{width:"auto","font-size":"30px"},attrs:{icon:"el-icon-microphone",circle:"",size:"mini",type:"primary",title:"Start Transcription"},on:{click:t.startFanl}}):t._e(),t.left?a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],staticStyle:{width:"auto",background:"#cb4c38","font-size":"30px",border:"#cb4c38"},attrs:{icon:"el-icon-turn-off-microphone",circle:"",size:"mini",type:"primary",title:"Stop Transcription"},on:{click:t.stopFanl}}):t._e(),t.left?a("span",{staticStyle:{"font-size":"14px",color:"#000","margin-left":"20px","vertical-align":"5px"}},[t._v("recording...")]):t._e(),t.start?a("span",{staticStyle:{"font-size":"14px",color:"#000","margin-left":"20px","vertical-align":"5px"}},[t._v("click to start")]):t._e()],1)]),2==t.index&&t.isMobile?a("div",{staticClass:"fs24 mobile1 mobile2"},[a("div",{staticClass:"topH"},[a("div",{staticClass:"header"},[a("i",{staticClass:"el-icon-plus",class:t.isCollapse?"unfold close":"unfold",on:{click:t.changeOpen}}),a("span",{staticStyle:{"font-size":"15px",float:"right","margin-right":"20px"},attrs:{slot:"label"},on:{click:t.back},slot:"label"},[t._v(" Leave Room ")])])]),a("el-tabs",{class:t.isCollapse?"tabs":"tabs tabs-close",attrs:{"tab-position":"left"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{staticStyle:{height:"100%"},attrs:{label:"TranscribeLive",name:"TranscribeLive"}},["audience"==t.options.role?a("div",{staticClass:"content"},[a("div",[a("span",[t._v("Room Name : "+t._s(this.options.channel))])]),t._l(t.userList,(function(e,n){return a("div",{key:n},[0==n?a("div",{staticClass:"item"},[a("div",{staticClass:"first"},[a("el-avatar",{attrs:{src:t.allData[e.uid].src}})],1),a("div",[a("div",{attrs:{id:"wrapperDiv"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"div1"}},[a("span",[t._v("User Name: "+t._s(e.name))]),a("span",[t._v(" (Self,Audience) ")]),a("div",{staticStyle:{float:"right"},attrs:{id:"div2"}},[t.left?a("el-button",{staticStyle:{"padding-left":"2px","padding-bottom":"2px","margin-left":"8px"},attrs:{circle:"",type:"success"}}):t._e()],1)])])])]):t._e(),n<5&&n>0?a("div",{staticClass:"itemContent"},[a("div",{staticClass:"top"},[a("div",{staticClass:"first"},[a("el-avatar",{attrs:{src:t.allData[e.uid].src}})],1),a("div",{attrs:{id:"wrapperDiv"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"div1"}},[a("span",[t._v("User Name: "+t._s(e.name))])])])]),t.allData[e.uid]?a("div",{staticClass:"bottom"},[a("p",{ref:"textContent",refInFor:!0,domProps:{innerHTML:t._s(t.allData[e.uid].stringBuilder)}})]):t._e()]):t._e()])}))],2):t._e(),"host"==t.options.role?a("div",{staticClass:"content"},[a("div",[a("span",[t._v("Room Name : "+t._s(this.options.channel))])]),t._l(t.userList,(function(e,n){return a("div",{key:n},[n<4?a("div",{staticClass:"itemContent"},[a("div",{staticClass:"top"},[a("div",{staticClass:"first"},[a("el-avatar",{attrs:{src:t.allData[e.uid].src}})],1),a("div",{attrs:{id:"wrapperDiv"}},[a("div",{staticStyle:{float:"left"},attrs:{id:"div1"}},[a("span",[t._v("User Name: "+t._s(e.name))]),0==n?a("span",[t._v(" (Self,Host)")]):t._e(),a("div",{staticStyle:{float:"right"},attrs:{id:"div2"}},[t.left?a("el-button",{staticStyle:{"padding-left":"2px","padding-bottom":"2px","margin-left":"8px"},attrs:{circle:"",type:"success"}}):t._e()],1)])])]),t.allData[e.uid]?a("div",{staticClass:"bottom"},[a("p",{ref:"textContent",refInFor:!0,domProps:{innerHTML:t._s(t.allData[e.uid].stringBuilder)}})]):t._e()]):t._e()])}))],2):t._e(),a("div",{staticStyle:{position:"fixed",top:"80vh",left:"50%","margin-left":"-24px",width:"200px","text-align":"left"}},[t.start?a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],staticStyle:{width:"auto","font-size":"30px"},attrs:{icon:"el-icon-microphone",circle:"",size:"mini",type:"primary",title:"Start Transcription"},on:{click:t.startFanl}}):t._e(),t.left?a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],staticStyle:{width:"auto",background:"#cb4c38","font-size":"30px",border:"#cb4c38"},attrs:{icon:"el-icon-turn-off-microphone",circle:"",size:"mini",type:"primary",title:"Stop Transcription"},on:{click:t.stopFanl}}):t._e(),t.left?a("span",{staticStyle:{"font-size":"14px",color:"#000","margin-left":"20px","vertical-align":"5px"}},[t._v("recording...")]):t._e(),t.start?a("span",{staticStyle:{"font-size":"14px",color:"#000","margin-left":"20px","vertical-align":"5px"}},[t._v("click to start")]):t._e()],1)]),a("el-tab-pane",{attrs:{label:"Full Transcription",name:"Full Transcription"}},[a("div",{staticClass:"drawerContent"},[a("p",[t._v(t._s(this.simpletext))])])]),a("el-tab-pane",{attrs:{label:"Conversation",name:"Conversation"}},[a("div",{staticClass:"drawerContent"},t._l(t.simpletextMetting,(function(e,n){return a("div",{key:n},[e.text?a("div",[a("p",[t._v(t._s(e.name)+" "+t._s(new Date(parseInt(e.time)).toLocaleString()))]),a("p",[t._v(t._s(e.text))])]):t._e()])})),0)])],1)],1):t._e(),2!=t.index||t.isMobile?t._e():a("div",{staticClass:"buttonList"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],attrs:{size:"mini",type:"primary",plain:""},on:{click:t.back}},[t._v("Leave Room")]),t.start?a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"mini",type:"primary",plain:""},on:{click:t.fanl}},[t._v("load transcription ")]):t._e(),t.start?a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"mini",type:"primary",plain:""},on:{click:t.noFanl}},[t._v("load close caption ")]):t._e(),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],attrs:{size:"mini",type:"primary",plain:""},on:{click:t.simpleText}},[t._v("Full Transcription")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],attrs:{size:"mini",type:"primary",plain:""},on:{click:t.simpleTextMeeting}},[t._v("Conversation")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.join,expression:"join"}],attrs:{size:"mini",type:"primary",plain:""},on:{click:t.profanity}},[t._v("Content Filter")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"mini",type:"primary",plain:"",disabled:!t.taskId},on:{click:t.queryFanl}},[t._v("Query status ")])],1),a("el-drawer",{attrs:{title:"load transcription",visible:t.drawerFanl},on:{"update:visible":function(e){t.drawerFanl=e}}},[t.outputStreamFanle.length?a("div",{staticClass:"drawerContent"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.clearFanl}},[t._v("clear cache")]),t._l(t.outputStreamFanle.split("</br>"),(function(e,n){return a("p",{key:n,domProps:{innerHTML:t._s(e)}})}))],2):a("div",{staticClass:"drawerContent"},[a("p",[t._v("empty")])])]),a("el-drawer",{attrs:{title:"load close caption",visible:t.drawer},on:{"update:visible":function(e){t.drawer=e}}},[t.outputStreamFanle.length?a("div",{staticClass:"drawerContent"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.clear}},[t._v("clear cache")]),t._l(t.outputStreamNoFanle.split("</br>"),(function(e,n){return a("p",{key:n,domProps:{innerHTML:t._s(e)}})}))],2):a("div",{staticClass:"drawerContent"},[a("p",[t._v("empty")])])]),a("el-drawer",{attrs:{title:"Full Transcription",visible:t.drawerFanlSimple},on:{"update:visible":function(e){t.drawerFanlSimple=e}}},[a("div",{staticClass:"drawerContent"},[a("p",[t._v(t._s(this.simpletext))])])]),a("el-drawer",{attrs:{title:"Conversation(Content Filter)",visible:t.drawerFanlProfanity},on:{"update:visible":function(e){t.drawerFanlProfanity=e}}},[a("div",{staticClass:"drawerContent"},[a("p",{domProps:{innerHTML:t._s(t.profanityStr)}})])]),a("el-drawer",{attrs:{title:"Conversation",visible:t.drawerFanlSimpleMetting},on:{"update:visible":function(e){t.drawerFanlSimpleMetting=e}}},[a("div",{staticClass:"drawerContent"},t._l(t.simpletextMetting,(function(e,n){return a("div",{key:n},[e.text?a("div",[a("p",[t._v(t._s(e.name)+" "+t._s(new Date(parseInt(e.time)).toLocaleString()))]),a("p",[t._v(t._s(e.text))])]):t._e()])})),0)]),a("el-dialog",{attrs:{title:"Settings",visible:t.dialogFormVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("p",{staticStyle:{"padding-right":"4px"}},[t._v("APP ID: "),a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"appId"},model:{value:t.appId,callback:function(e){t.appId=e},expression:"appId"}})],1),a("el-form",{ref:"form",staticStyle:{"margin-left":"-3rem"},attrs:{model:t.options,"label-width":"110px",rules:t.rules}},[a("el-form-item",{attrs:{label:"AEC:"}},[a("el-radio-group",{staticStyle:{"margin-left":"-8rem"},model:{value:t.options.AEC,callback:function(e){t.$set(t.options,"AEC",e)},expression:"options.AEC"}},[a("el-radio",{staticStyle:{"margin-right":"-1rem"},attrs:{label:!0}},[t._v("Open")]),a("el-radio",{attrs:{label:!1}},[t._v("Close")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Acoustic Echo Cancellation",placement:"top-start"}},[a("el-button",{staticClass:"tooltip",staticStyle:{padding:"0% !important,margin-right: -1rem"},attrs:{icon:"el-icon-info",circle:"","data-coreui-placement":"top"}})],1)],1)],1),a("el-form-item",{attrs:{label:"AGC:"}},[a("el-radio-group",{staticStyle:{"margin-left":"-8rem"},model:{value:t.options.AGC,callback:function(e){t.$set(t.options,"AGC",e)},expression:"options.AGC"}},[a("el-radio",{staticStyle:{"margin-right":"-1rem"},attrs:{label:!0}},[t._v("Open")]),a("el-radio",{attrs:{label:!1}},[t._v("Close")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Audio Gain Control",placement:"top-start"}},[a("el-button",{staticClass:"tooltip",staticStyle:{padding:"0% !important,margin-right: -1rem"},attrs:{icon:"el-icon-info",circle:"","data-coreui-placement":"top"}})],1)],1)],1),a("el-form-item",{attrs:{label:"ANS:"}},[a("el-radio-group",{staticStyle:{"margin-left":"-8rem"},model:{value:t.options.ANS,callback:function(e){t.$set(t.options,"ANS",e)},expression:"options.ANS"}},[a("el-radio",{staticStyle:{"margin-right":"-1rem"},attrs:{label:!0}},[t._v("Open")]),a("el-radio",{attrs:{label:!1}},[t._v("Close")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Automatic Noise Suppression",placement:"top-start"}},[a("el-button",{staticClass:"tooltip",staticStyle:{padding:"0% !important,margin-right: -1rem"},attrs:{icon:"el-icon-info",circle:"","data-coreui-placement":"top"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("Cancel")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("Confirm")])],1)],1)],1)},i=[],r=a("1da1"),s=(a("96cf"),a("e9c4"),a("d81d"),a("b64b"),a("4de4"),a("d3b7"),a("159b"),a("b0c0"),a("fb6a"),a("25f0"),a("a15b"),a("caad"),a("a434"),a("99af"),a("ac1f"),a("1276"),a("b680"),a("2532"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("e671")),o=a.n(s),l=a("6f91"),c=a.n(l),u=a("b321"),p=a.n(u),d=a("bc3a"),m=a.n(d),f=(a("2ef0"),a("4be7"),"4135901d9c8b4f0cb09fbb51fd7508ff"),v={data:function(){return{rtc:{localAudioTrack:null,client:null},userList:[],hostList:[],token:null,uid:null,appId:f,start:!0,left:!1,loading:!1,taskId:"",join:!1,index:1,tokenName:"",rtmClient:"",options:{channel:"",role:"host",userName:"",AEC:!0,AGC:!0,ANS:!0},pollingWorker:"",rules:{channel:[{required:!0,message:"roomName is required",trigger:"blur"}],userName:[{required:!0,message:"userName is required",trigger:"blur"}]},allData:{},lastSeqnum:-1,finalLists:{},nonFinalList:{},outputStreamFanle:"",outputStreamNoFanle:"",createTs:"",drawer:!1,drawerFanl:!1,drawerFanlSimple:!1,simpletext:"",dialogFormVisible:!1,drawerFanlSimpleMetting:!1,simpletextMetting:[],rtmChannel:"",profanityStr:"",drawerFanlProfanity:!1,isCollapse:!1,isMobile:!1,activeName:"TranscribeLive"}},created:function(){window.screen.width<500&&(this.isMobile=!0)},mounted:function(){var t=this;window.addEventListener("beforeunload",(function(e){return t.beforeunloadHandler(e)}))},beforeDestroy:function(){this.rtc.localAudioTrack&&this.leaveRoom(),this.taskId&&this.tokenName&&this.stopFanl()},methods:{changeOpen:function(){this.isCollapse=!this.isCollapse},handleClick:function(){this.isCollapse=!1},clearFanl:function(){var t=this;this.$confirm("Are you sure to clear fanle","tip",{confirmButtonText:"sure",cancelButtonText:"cancle",type:"warning"}).then((function(){t.outputStreamFanle="",localStorage.setItem("outputStreamFanle",""),t.$message({type:"success",message:"success!"})})).catch((function(){t.$message({type:"info",message:"cancle"})}))},clear:function(){var t=this;this.$confirm("Are you sure to clear no-Fanle","tip",{confirmButtonText:"sure",cancelButtonText:"cancle",type:"warning"}).then((function(){t.outputStreamNoFanle="",localStorage.setItem("outputStreamNoFanle",""),t.$message({type:"success",message:"success!"})})).catch((function(){t.$message({type:"info",message:"cancle"})}))},fanl:function(){this.drawerFanl=!0},simpleText:function(){this.drawerFanlSimple=!0},simpleTextMeeting:function(){this.drawerFanlSimpleMetting=!0},profanity:function(){this.drawerFanlProfanity=!0},noFanl:function(){this.drawer=!0},isOAverdue:function(){return!this.tokenName||Date.now()/1e3-this.createTs>=300},onSubmit:function(){var t=this;this.$refs["form"].validate((function(e){if(!e)return!1;t.index=2,t.outputStreamFanle=localStorage.getItem("outputStreamFanle")?localStorage.getItem("outputStreamFanle"):"",t.outputStreamNoFanle=localStorage.getItem("outputStreamNoFanle")?localStorage.getItem("outputStreamNoFanle"):"",t.start=!0,t.left=!1,t.tokenName="",t.activeName="TranscribeLive",t.startBasicCall()}))},back:function(){this.index=1,this.start=!1,this.left=!0,this.hostList=[],this.userList=[],this.beforeunloadHandler(),this.outputStreamNoFanle="",this.outputStreamFanle=""},rtmMemberJoined:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i,r,s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.rtmClient.getChannelAttributes(t);case 2:i=n.sent,r=JSON.parse(JSON.stringify(e.userList)),s=Object.keys(i).map((function(t){return{uid:t,name:i[t]}})),o=s.filter((function(t){return!r.some((function(e){return e.uid==t.uid}))})),o.forEach((function(t){e.userList.push({uid:t.uid,name:t.name.value,online:!1}),e.allData[t.uid]={src:a("2ed3")("./avatar"+t.uid.toString().slice(-1)+".png"),name:t.name.value}}));case 7:case"end":return n.stop()}}),n)})))()},rtmMemberLeft:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.rtmClient.deleteChannelAttributesByKeys(t.options.channel,[t.uid.toString()]);case 2:case"end":return e.stop()}}),e)})))()},startBasicCall:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o.a.setLogLevel(4),t.rtc.client=o.a.createClient({mode:"live",codec:"vp8",role:t.options.role}),t.rtmClient=c.a.createInstance(t.appId,{enableLogUpload:!1}),n={},n.uid=t.options.userName,n.token=null,e.next=8,t.rtmClient.login(n).then((function(){console.log("RTM join success")})).catch((function(t){console.log("RTM join failed")}));case 8:return e.next=10,t.rtmClient.createChannel(t.options.channel);case 10:return i=e.sent,t.rtmChannel=i,e.next=14,i.join().then((function(){console.log("RTM")})).catch((function(t){console.log("channel RTM failed")}));case 14:t.rtc.client.on("user-published",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a,n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.rtc.client.subscribe(a,n);case 2:e.sent,a.uid.toString(),"audio"===n&&(i=a.audioTrack,i.play()),t.rtc.client.on("user-unpublished",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.rtc.client.unsubscribe(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),t.rtc.client.on("user-joined",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if([1e3,2e3].includes(n.uid)){e.next=7;break}return t.hostList.push(n.uid),e.next=4,t.rtmClient.getChannelAttributes(t.options.channel);case 4:i=e.sent,console.log(i),i[n.uid]&&(t.userList.push({uid:n.uid,name:i[n.uid].value,online:!1}),t.allData[n.uid]={src:a("2ed3")("./avatar"+n.uid.toString().slice(-1)+".png"),name:i[n.uid].value});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.rtc.client.on("user-left",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.allData[a.uid]&&(delete t.allData[a.uid],t.userList.splice(t.hostList.indexOf(a.uid),1),t.hostList.splice(t.hostList.indexOf(a.uid),1));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),t.rtc.client.on("stream-message",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.uint8Array(n);case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),t.joinRoom(i);case 19:case"end":return e.stop()}}),e)})))()},joinRoom:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.rtc.client.join(e.appId,e.options.channel,e.token,e.uid);case 2:return i=n.sent,e.join=!0,e.uid=i,e.hostList.push(i),r=e.options.userName,s=i.toString(),window.userInfo={},userInfo[s]=r,n.next=12,e.rtmClient.addOrUpdateChannelAttributes(t.channelId,userInfo);case 12:return e.userList.unshift({uid:s,name:r,online:!1}),e.allData[s]={src:a("2ed3")("./avatar"+s.toString().slice(-1)+".png"),name:r},n.next=16,o.a.createMicrophoneAudioTrack({AEC:e.options.AEC,AGC:e.options.AGC,ANS:e.options.ANS});case 16:if(e.rtc.localAudioTrack=n.sent,"host"!=e.options.role){n.next=20;break}return n.next=20,e.rtc.client.publish([e.rtc.localAudioTrack]);case 20:case"end":return n.stop()}}),n)})))()},leaveRoom:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.start=!0,t.left=!1,t.join=!1,t.rtc.localAudioTrack.close(),e.next=6,t.rtmMemberLeft();case 6:return e.next=8,t.rtc.client.leave();case 8:return e.next=10,t.rtmChannel.leave();case 10:return e.next=12,t.rtmClient.logout();case 12:t.uid="";case 13:case"end":return e.stop()}}),e)})))()},getBuilderTokens:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:m.a.post("/api/v1/projects/".concat(f,"/rtsc/speech-to-text/builderTokens"),{instanceId:e.options.channel}).then((function(a){200==a.status?(e.tokenName=a.data.tokenName,e.createTs=a.data.createTs,1==t&&e.startFanl()):e.$message.error("网络异常")})).catch((function(t){e.$message.error(t.response.data.message?t.response.data.message:"网络异常")}));case 1:case"end":return a.stop()}}),a)})))()},startFanl:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.loading=!0,t.simpletext="","host"!=t.options.role){e.next=5;break}return e.next=5,t.rtc.client.publish([t.rtc.localAudioTrack]);case 5:t.isOAverdue()?t.getBuilderTokens(1):m.a.post("/api/v1/projects/".concat(f,"/rtsc/speech-to-text/tasks?builderToken=").concat(t.tokenName),{audio:{subscribeSource:"AGORARTC",agoraRtcConfig:{channelName:t.options.channel,uid:"1000",token:"",channelType:"LIVE_TYPE",subscribeConfig:{subscribeMode:"CHANNEL_MODE"},maxIdleTime:60}},config:{features:["RECOGNIZE"],recognizeConfig:{language:"ENG",model:"Model",connectionTimeout:60,output:{destinations:["AgoraRTCDataStream"],agoraRTCDataStream:{channelName:t.options.channel,uid:"2000",token:""}}}}}).then((function(e){200==e.status?(t.start=!1,t.loading=!1,t.left=!0,t.taskId=e.data.taskId,t.createWorker((function(){t.taskId&&(console.log(new Date),t.stopFanl())}),6e5)):(t.loading=!1,t.$message.error("network anomaly"))})).catch((function(e){t.loading=!1,t.start=!0,t.$message.error(e.response.data.message?e.response.data.message:"network anomaly")}));case 6:case"end":return e.stop()}}),e)})))()},stopFanl:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,t.loading=!0,e.next=4,fetch("/api/v1/projects/".concat(f,"/rtsc/speech-to-text/tasks/").concat(t.taskId,"?builderToken=").concat(t.tokenName),{method:"delete",keepalive:!0,headers:{"content-type":"application/json"}});case 4:return n=e.sent,e.next=7,n.text();case 7:i=e.sent,r=JSON.parse(i),r.message?(a.loading=!1,a.$message.error(r.message?r.message:"network anomaly")):(a.start=!0,t.left=!1,a.loading=!1,a.taskId="",a.tokenName="",a.stopWorker(a.pollingWorker));case 10:case"end":return e.stop()}}),e)})))()},queryFanl:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.taskId){e.next=2;break}return e.abrupt("return",t.$message.error("There are currently no tasks"));case 2:a=t,fetch("/api/v1/projects/".concat(f,"/rtsc/speech-to-text/tasks/").concat(t.taskId,"?builderToken=").concat(t.tokenName),{method:"get",headers:{"content-type":"application/json"}}).then((function(t){return t.text()})).then((function(t){var e=JSON.parse(t);e.status?a.$message.success("current task status".concat(e.status)):a.$message.error(e.message?e.message:"network anomaly")}));case 4:case"end":return e.stop()}}),e)})))()},uint8Array:function(t){var e=this,a=p.a.lookup("Text").decode(t),n=a.words;if(a.seqnum!==this.lastseqnum&&(this.lastSeqnum=a.seqnum,!(this.hostList.indexOf(a.uid)>=4&&"host"==this.options.role||this.hostList.indexOf(a.uid)>=5&&"audience"==this.options.role))){this.finalLists[a.uid]||(this.finalLists[a.uid]=[]),this.nonFinalList[a.uid]||(this.nonFinalList[a.uid]=[]);var i=[],r="",s="",o="",l="";if(n.forEach((function(t){e.isProfanityWord(t.text)&&(t.isFinal&&(l+=t.text.split(":")[0].split("[")[1]+" -> "+t.text.split(":")[1].split("]")[0]+" ; "),t.text=t.text.split(":")[0].split("[")[1]),t.isFinal?(e.finalLists[a.uid].push(t.text),e.isSentenceBoundaryWord(t.text)&&(e.finalLists[a.uid]=[]),r+="<span class='red'>"+a.uid+"</span> <span class='blue'>"+t.text+"</span> <span class='yellow'>("+t.confidence.toFixed(2)+")</span> ",e.simpletext.length>0&&!e.isPunctuationWord(t.text)&&(e.simpletext+=" ",o+=" "),o+=t.text,e.simpletext+=t.text):(s+="<span class='red'>"+a.uid+"</span> <span class='blue'>"+t.text+"</span> <span class='yellow'>("+t.confidence.toFixed(2)+")</span> ",i.push(t.text))})),r.length&&(this.outputStreamFanle+=new Date(parseInt(a.time)).toLocaleString()+" "+r+"</br>"),s.length&&(this.outputStreamNoFanle+=new Date(parseInt(a.time)).toLocaleString()+" "+s+"</br>"),o.length){var c=!1;this.simpletextMetting.forEach((function(t){t.uid==a.uid&&a.time-t.time<6e4&&(t.text+=o,c=!0)})),!c&&this.allData[a.uid]&&this.simpletextMetting.push({name:this.allData[a.uid].name,uid:a.uid,time:a.time,text:o})}l.length&&(this.profanityStr+=this.allData[a.uid].name+" "+a.uid+" "+new Date(parseInt(a.time)).toLocaleString()+"</br>"+l+"</br>");var u="";this.finalLists[a.uid].forEach((function(t){u.length>0&&!e.isPunctuationWord(t)&&(u+=" "),u+=t})),i.forEach((function(t){u.length>0&&!e.isPunctuationWord(t)&&(u+=" "),u+=t})),this.allData[a.uid]&&(this.allData[a.uid].stringBuilder=u),this.$forceUpdate()}},isPunctuationWord:function(t){return"."==t||"?"==t||","==t},isSentenceBoundaryWord:function(t){return"."==t||"?"==t},isProfanityWord:function(t){return t.includes("[")},wordsToText:function(t){var e=this,a="";return t.forEach((function(t){a.length>0&&!e.isPunctuationWord(t)&&(a+=" "),a+=t})),a},beforeunloadHandler:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.taskId||!e.tokenName){a.next=3;break}return a.next=3,e.stopFanl();case 3:if(!e.rtc.localAudioTrack){a.next=6;break}return a.next=6,e.leaveRoom();case 6:return localStorage.setItem("outputStreamNoFanle",e.outputStreamNoFanle),localStorage.setItem("outputStreamFanle",e.outputStreamFanle),n="Are you sure you want to leave?",(t||window.event).returnValue=n,a.abrupt("return",n);case 11:case"end":return a.stop()}}),a)})))()},create:function(t){var e=new Blob(["("+t+")()"]),a=window.URL.createObjectURL(e),n=new Worker(a);return n},createWorker:function(t,e){this.pollingWorker=this.create("function (e) {\n          setInterval(function () {\n              this.postMessage(null)\n          }, ".concat(e,")\n      }")),this.pollingWorker.onmessage=t},stopWorker:function(t){try{t&&t.terminate()}catch(e){console.log(e)}}}},h=v,g=(a("46ea"),a("2877")),b=Object(g["a"])(h,n,i,!1,null,null,null);e["default"]=b.exports},e57d:function(t,e,a){},f23c:function(t,e,a){t.exports=a.p+"static/img/avatar6.8cb5b3f4.png"}}]);